# 事件分析

事件，是指用户在应用上发生的行为，即何人，何时，何地，通过何种方式，做了什么事。

事件分析模型主要用于分析用户在应用上的行为，比如打开小程序、注册、登录、支付订单等。通过触发用户数、触发次数、访问时长等指标度量用户行为和业务过程。

## 事件分析能解决哪些问题？

1. 如何监测产品每天的用户数、访问次数、使用时长？趋势是否发生了变化？引起变化的因素有哪些？
2. 北京地区的用户和上海地区的用户，购买家电品类的金额分布差异在哪里？
3. 今天在产品中发起了一个话题，各个时段用户的参与情况如何？

    ……

## 使用准备

梳理业务，确定采集方案，邀请工程师集成 SDK，以 **事件 - 事件属性 - 属性值** 的结构埋点采集事件各个要素（详细说明见[小程序 SDK 使用说明](./sdk-wx.md)），上报数据。

**事件：**记录用户触发的行为，例如 注册、登录、支付等等；

**事件属性：**更精准的描述用户行为，例如事件发生的位置、方式和内容；

**属性值：**属性的具体值，不同的属性，属性值不同，例如，支付方式的属性值，可以是微信支付，支付宝支付；设备品牌的属性值，可以是小米，锤子。

Event要素 | 要素说明|采集的数据 |示例 |
---|---|---|---
Who | 参与事件的用户|用户唯一ID |H522a3bd525a2af
When | 事件发生的时间|自动获取 事件当时时间 |11月11日00:02:03
Where | 事件发生的地理位置|自动获取 IP、GPS信息 |114.242.249.113
How | 事件发生的方式 |使用的环境 |设备品牌：Apple <br>设备型号：iPhone 6s<br>操作系统：iOS<br>屏幕分辨率：1920*1680<br>运营商：中国联通 <br>网络类型：Wifi<br>……
What | 事件的内容|自定义采集的事件：EventID <br>       事件属性：Key-Value |add_to_cart <br> product_name：耳麦<br> product_price：666

## 功能介绍

![image](https://imguserradar.analysys.cn/fangzhou/img/2018/10/201810241151476197.png)

### 1. 定义指标区

上方为指标定义区域，选择要分析的指标，细分维度查看，支持条件过滤，观察指标表现，支持多个人群的对比分析。

#### 1.1 选择指标

从下拉框中选择指标，可以选择单个指标来分析，也可以选择多个进行对比。

**指标有两种组成结构：**

- **事件 - 事件支持的指标**，e.g. 登录的触发用户数

- **事件 - 事件的属性 - 属性值支持的指标**，e.g.提交支付的支付金额的总和

![image](http://imguserradar.analysys.cn/fangzhou/img/2018/03/201803301613547277.png)

**事件有两种类型：**

- **系统默认事件：**总体访问、首次访问、浏览页面、着陆页、退出页

- **自定义元事件：**通过代码埋点

**属性值的有五种类型：**

- 字符串
- 数值型
- 布尔值
- 日期时间
- 字符串集合

**对所有事件都支持计算的指标：**

触发用户数：触发选定事件的去重用户数，e.g. 加入购物车的触发用户数

触发次数：触发选定事件的总次数，e.g. 加入购物车的触发次数

人均触发次数： 平均每个用户触发选定事件的次数，e.g.加入购物车的人均触发次数

**对所有属性值类型的属性都支持计算的指标**：

去重数：在选定时间范围内，该属性出现的独立去重个数，e.g.加入购物车商品的数量

**对数值型属性值的属性支持计算的指标：**

总和：选定属性的属性值求和，e.g. 加入购物车的商品金额之和

均值：选定属性的属性值算数平均数，e.g. 加入购物车的商品金额均值

最大值：选定属性的属性值最大值，e.g. 加入购物车的商品最大金额

最小值：选定属性的属性值最小值，e.g. 加入购物车的商品最小金额

人均值：选定属性的属性值人均值，e.g. 人均加入购物车的商品金额

> 注意：在集成 SDK 时，不同类型的属性值需要满足不同的数据格式，才能在分析时正确使用，详见《[小程序 SDK 使用说明](./sdk-wx)》

#### 1.2 细分维度

**维度**指人们分析事物的角度。比如，分析活跃用户，可以从时间的维度，也可以从地域的维度去看，也可以时间、地域两个维度组合去分析。

有层次关系的维度，就可以根据分析需求改变维的层次，变换分析的粒度钻取，比如从地域这个维度类型上，可以细分到省份、城市、县、乡镇的用户，也可以向上汇总。

维度也可以分为定性维度和定量维度（根据数据类型划分）。数据类型为字符型即定性维度，如城市、性别等；数据类型为数值型数据的即定量维度，如收入、年龄、消费金额等，定量维度一般需要数值分组处理，比如年龄划分为 20岁以下，20~29岁，30~39岁等，更多类型如下：

属性值数据类型 |维度处理方式
---|---
字符串 |按离散值
数值型 |自定义分组、按离散值
布尔值 |按离散值
日期时间 |按分钟、小时、日、周、月、季、年
字符串集合 |按离散值

**单个指标时**，支持细分的维度，包括事件自定义属性、事件通用属性、用户属性；

**多个指标时**，支持细分的维度，包括公共的属性、事件通用属性、用户属性。

维度选择下拉框中，对 **数值型** 和 **日期时间型** 做特殊标识；当分组个数超出 10个时，默认展示最近的时间单位内指标数值最大的 10个分组，可以在图例自行选择其他的分组。

**A. 数值型维度分组方法**

![image](http://imguserradar.analysys.cn/fangzhou/img/2018/03/201803301613542364.png)

**B.日期型维度分组方法**

![image](http://imguserradar.analysys.cn/fangzhou/img/2018/03/201803301613544715.png)

#### 1.3 增加过滤条件

可以添加公共过滤条件，约束多个指标

条件按照 **属性 - 运算符 - 属性值** 的结构构成，属性包括**事件自定义属性**、**通用属性**、**用户属性**三种类型。
不同的属性值的数据类型支持不同的操作符：

**A. 字符串**

操作符 |使用场景 |e.g.
---|------|---
=(等于) |等于某个具体确定的属性值 |设备品牌 = 苹果；
≠（不等于） |完全排除输入的某个或多个属性值 |设备品牌 ≠ 苹果；
∋（属于） |表示满足其中的一项或多项 |设备品牌 满足 苹果、小米中的任意一个
∌（不属于） |完全排除输入的多个属性值 |设备品牌 不满足 苹果、小米中的任何一个
like（模糊匹配） |查找属性值中包含某些字符的值 |设备品牌 中 包含 苹果 这个词的
notlike（不匹配） |排除属性值中包含某些字符的值 |设备品牌中 不包含 苹果 这个词的

> 注：对于包含字典属性，目前不支持 like（模糊匹配）和 notlike（不匹配）。

**B. 数值型**

操作符 |使用场景| e.g.
---|------|---
=（等于） |等于某个具体数字| 商品金额 = 100
≠（不等于）|不等于某个数字| 商品金额 ≠ 100
<（小于）| 小于某个数字| 商品金额 < 100
≤（小于等于）| 小于等于某个数字 |商品金额 ≤ 100
>（大于） |大于某个数字 |商品金额 ＞ 100
≥（大于等于）| 大于等于某个数字 |商品金额 ≥ 100
介于区间 |在某个数据区间内的数值| 100＜商品金额 ≤ 500

> 注：对于区间，支持自定义开区间还是闭区间

**C. 布尔值**

操作符| 使用场景| e.g.
---|------|---
为真 |某个判断为真 |是否成功 = 是
为假 |某个判断为假 |是否成功 = 否

**D. 日期时间**

操作符 |使用场景| e.g.
---|------|---
在日期范围___________内 |在某个时间范围 |在 2018/01/12 - 2018/02/02
在近_____天内 |在相对当前的某段时间里| 在近 30 天内

**E. 字符串集合**

操作符 |使用场景| e.g.
---|------|---
like（模糊匹配）| 集合中包含某个字符的值 |用户标签 like 摄影
notlike（不匹配） |集合中不包含某个字符的值 |用户标签 notlike 摄影

#### 1.4 .筛选人群

选择单个指标时，可以对比多个人群该指标表现

![image](http://imguserradar.analysys.cn/fangzhou/img/2018/03/201803301613543230.png)

### 2. 图表展示

图表展示区，可以选择时间范围，时间粒度，图表样式

#### 2.1 时间范围

![image](http://imguserradar.analysys.cn/fangzhou/img/2018/03/201803301613549551.png)

可以选择本周、上月等快捷方式，也可以选择具体某个开始时间、结束时间，当选择的是相对时间保存图表后，会展示动态的时间范围。
e.g. 今天是 3月16日，选择了本周，可以查看的是 3月12日至3月16日，即周一至周五的数据；当下周三打开保存的该图表时，查看到将是 3月19日至3月21日，即周一至周三的数据。

#### 2.2 时间粒度

可选择的时间粒度，包括

时间粒度 |说明
---|------
按分钟| 按分钟聚合，实时计算，最多延迟 10分钟
按小时| 按小时聚合，实时计算，最多延迟 10分钟
按日| 默认按照从 00:00:00 到 23:59:59 的完整日聚合，当时间范围中包含今日时，每 2小时聚合一次，e.g. 现在 17:40，则当前显示的是，从 0点到 16：00的结果；到了 18:00时，开始计算 0点到 18点的聚合结果。
按周| 默认周一到周日的自然周聚合，当时间范围不足自然周时，计算的是选择范围内所在周若干天的聚合
按月| 当时间范围不足自然月时，计算的是选择范围内所在月若干天的聚合

#### 2.3 图表样式

不同的指标、条件、人群、维度组合可以可视化呈现，譬如

**A. 新老用户流量对比**

![image](https://imguserradar.analysys.cn/fangzhou/img/2018/10/201810241152534190.png)

**B. 不同版本的活跃用户趋势**

![image](https://imguserradar.analysys.cn/fangzhou/img/2018/10/201810241159198965.png)

**C. 不同城市的用户购买金额趋势**

![image](https://imguserradar.analysys.cn/fangzhou/img/2018/10/201810241157005696.pngg)

**D. 不同用户群访问小程序的次数**

![image](https://imguserradar.analysys.cn/fangzhou/img/2018/10/201810241204013895.png)

更多使用场景期待您的挖掘，如有更多有关问题，请随时联系我们 **4006-010-231**。