# 私有云安装部署

## **硬件要求**

参考硬件标准如下：

增加DAU计算模型和公式

![ ](../../.gitbook/assets/wx20190531-150118%20%281%29.png)

## **软件环境**

### **操作系统**

CentOS官网ISO镜像，6.9、7.2、7.4，推荐7.4版本。

### **网络环境**

| 需要提供对外服务的端口 |  |  |  |
| :--- | :--- | :--- | :--- |
| **序号** | **协议** | **端口号** | **端口作用说明** |
| 1 | http | 4005 | 方舟系统报表界面 |
| 2 | 8080 | 方舟系统监控端口 |  |
| 3 | 8089 | 收集SDK上送数据 |  |
| 4 | ws | 9091 | 可视化请求配置信息端口 |

## **开始安装**

### **准备工作**

获得安装介质

联系我们，将会获得安装介质及专业的工程师指导。

北京市朝阳区酒仙桥路10号恒通国际商务园-B12C座三层

[https://www.analysys.cn/](https://www.analysys.cn/)

邮编：100015

电话：4006-010-230

传真：010-64668599

· 安装环境检查

执行环境检查脚本检查系统环境是否合乎安装规格要求。这里可以了解到详细的检查步骤。

### **配置/etc/hosts**

登陆服务器，执行

hostname -f

查看该服务器的主机名,如果返回的结果不是ark1，则说明该服务器没有设置主机名。

以root用户或sudo执行

hostnamectl set-hostname ark1

检查主机名是否设置成功：

hostname -f

命令查看返回值，如果是我们设置的主机名，主机名设置成功！

配置/etc/hosts文件，使用vi命令编辑该文件

vi /etc/hosts

添加内容如下

${该服务器的内网ip} arkXXX.analysys.xyz arkXXX

有3列内容，第一列为主机的ip地址，第二列是Ambari使用的FANQ格式的主机名,第三列是该ip对应的主机名，确保所有服务器的hosts文件一致。

### **一键安装**

以下操作为样例

1. cd /opt/soft

sh standalone\_offline\_installer.sh install Grafana\_123 4.1.17 centos7 root 'HJUiju\)@\)$' platformName  32

2. 参数定义：

| **参数** | **定义** |
| :--- | :--- |
| Grafana\_123 | mysql的root密码 |
| 4.1.17 | 方舟的版本号 |
| centos7 | 操作系统的类型 |
| root | 安装用户 |
| 'HJUiju\)@\)$' | root用户的密码 |
| platformName | 环境名称，只能是英文字母和数字 |
| 32 | 服务器内存的大小，支持32/64/128三种配置 |

注意：该脚本不允许nohup后台执行，因为过程中会有询问您的操作的过程，所以请关注脚本的输出。

3. 在安装的过程中可以通过访问 [http://ark1.analysys.xyz:8080](http://ark1.analysys.xyz:8080/) 界面来查看安装细节，但请不要做任何操作，等待脚本执行完成。

4. 安装过程中需要交互确认，需要您输入yes来确认

### **安装检查**

浏览器输入 http://${该服务器的内网ip}:8080，登陆进入后操作如下： 

![](file:////var/folders/7c/_my__gds16z2c7w60wrp1_xc0000gn/T/com.kingsoft.wpsoffice.mac/wps-liuhongwei/ksohtml/wpss5YuEh.jpg)按上图中的1、2、3步骤操作完成，直到没有红色叹号的服务。需要注意的是，由于服务状态检查有一定的延时，所以在安装完成过几分钟后再进行该操作，操作完成后也需要观察一段时间再看结果。

### **导入License**

联系我们，您将获得正式授权的license文件，这将保障您的数据获得正确处理和分析。 

部署完成！

